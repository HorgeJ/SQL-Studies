# SQL Reporting Examples

### Reports will be made by querying a middle schools database with 7 tables. Students table, Teachers table, Subjects table, Rooms table, Periods table, Classes table, Schedule table.

**STUDENTS TABLE
```
CREATE TABLE STUDENTS (
    ID INT PRIMARY KEY,
    FIRST_NAME TEXT,
    LAST_NAME TEXT,
    GRADE INT
)
```

**TEACHERS TABLE
```
CREATE TABLE TEACHERS (
    ID INT PRIMARY KEY,
    FIRST_NAME TEXT,
    LAST_NAME TEXT,
)
```

**SUBJECTS TABLE
```
CREATE TABLE SUBJECTS (
    ID INT PRIMARY KEY,
    NAME TEXT,
    GRADE TEXT,
    DESCRIPTION TEXT
)
```

**ROOMS TABLE
```
CREATE TABLE ROOMS (
    ID INT PRIMARY KEY,
    CAPACITY INT
)
```

**PERIODS TABLE
```
CREATE TABLE PERIODS (
    ID INT PRIMARY KEY,
    START_TIME TEXT,
    DURATION INT
)
```

**CLASSES TABLE
```
CREATE TABLE TEACHERS (
    ID INT PRIMARY KEY,
    SUBJECT_ID INT,
    PERIOD_ID INT,
    TEACHER_ID INT,
    ROOM_ID INT,
    FOREIGN KEY(SUBJECT_ID) REFRENCES SUBJECTS(ID),
    FOREIGN KEY(PERIOD_ID) REFRENCES PERIODS(ID),
    FOREIGN KEY(TEACHER_ID) REFRENCES TEACHERS(ID),
    FOREIGN KEY(ROOM_ID) REFRENCES ROOMS(ID)
)
```

**SCHEDULE TABLE
```
CREATE TABLE SCHEDULE (
    ID INT PRIMARY KEY,
    STUDENT_ID INT,
    FOREIGN KEY(CLASS_ID) REFRENCES CLASSES(ID),
    FOREIGN KEY(STUDENT_ID) REFRENCES STUDENTS(ID)
)
```

* Which subjects are taught at the middle school?
```SQL
SELECT * FROM SUBJECTS;
```

* How many students do they have at the middle school?
```SQL
SELECT COUNT(*) FROM STUDENTS;
```

* What's Yvette Levy's student ID number?
```SQL
SELECT ID FROM STUDENTS 
WHERE FIRST_NAME = "Yvette" 
AND LAST_NAME = "Levy";
```

* Generate a list of teachers sorted alphabetically by last name.
```SQL
SELECT FIRST_NAME, LAST_NAME FROM TEACHERS
ORDER BY LAST_NAME ASC;
```

* Which students have last names starting with 'A'?
```SQL
SELECT ID, FIRST_NAME, LAST_NAME FROM STUDENTS
WHERE LAST_NAME LIKE 'A%';
```

* What's the total capacity of the school?
```SQL
SELECT SUM(CAPACITY)AS School_Capacity FROM ROOMS;
```

* Which room has the largest capacity?
```SQL 
SELECT ID, MAX(CAPACITY) AS School_Capacity FROM ROOMS;
```

* Which subject/s are taught in room 19?
```SQL
SELECT DISTINCT(NAME) FROM CLASSES
INNER JOIN SUBJECTS ON CLASSES.SUBJECT_ID = SUBJECTS.ID
WHERE CLASSES.ROOM_ID = 19;
```

* Which teachers teach only students in 8th grade
```SQL
SELECT DISTINCT TEACHERS.ID, TEACHERS.FIRST_NAME, TEACHERS.LAST_NAME FROM CLASSES
INNER JOIN TEACHERS ON CLASSES.TEACHER_ID = TEACHERS.ID
INNER JOIN SUBJECTS ON CLASSES.SUBJECT_ID = SUBJECTS.ID
WHERE GRADE = 8;
```

* Which teacher teaches 7th grade science?
```SQL
SELECT DISTINCT TEACHERS.ID, TEACHERS.FIRST_NAME, TEACHERS.LAST_NAME FROM TEACHERS
INNER JOIN CLASSES ON TEACHERS.ID = CLASSES.TEACHER_ID
INNER JOIN SUBJECTS ON CLASSES.SUBJECT_ID = SUBJECTS.ID
WHERE SUBJECTS.GRADE = 7 AND SUBJECTS.NAME = "Science";
```

* Which teachers teach elective subjects (subjects without grade levels)?
```SQL
SELECT DISTINCT TEACHERS.ID, TEACHERS.FIRST_NAME, TEACHERS.LAST_NAME FROM CLASSES
INNER JOIN SUBJECTS ON CLASSES.SUBJECT_ID = SUBJECTS.ID
INNER JOIN TEACHERS ON CLASSES.TEACHER_ID = TEACHERS.ID
WHERE GRADE IS NULL;
```

* Generate a schedule for Rex Rios.
```SQL
SELECT PERIODS.ID, TEACHERS.LAST_NAME, SUBJECTS.NAME, PERIODS.START_TIME, PERIODS.DURATION FROM SCHEDULE
INNER JOIN STUDENTS ON SCHEDULE.STUDENT_ID = STUDENTS.ID
INNER JOIN CLASSES ON SCHEDULE.CLASS_ID = CLASSES.ID
INNER JOIN SUBJECTS ON CLASSES.SUBJECT_ID = SUBJECTS.ID
INNER JOIN PERIODS ON CLASSES.PERIOD_ID = PERIODS.ID
INNER JOIN TEACHERS ON CLASSES.TEACHER_ID = TEACHERS.ID
WHERE STUDENTS.ID = 10399
ORDER BY PERIODS.ID ASC;
```

* How many students have Physical Education during first period?
```SQL
SELECT COUNT(*) FROM STUDENTS
JOIN SCHEDULE ON STUDENTS.ID = SCHEDULE.STUDENT_ID
JOIN CLASSES ON SCHEDULE.CLASS_ID = CLASSES.ID
JOIN SUBJECTS ON CLASSES.SUBJECT_ID = SUBJECTS.ID
WHERE SUBJECTS.NAME = "Physical Education" AND CLASSES.PERIOD_ID = 1;
```

* Generate a list of students with last names from A to M.
```SQL
SELECT LAST_NAME FROM STUDENTS
WHERE LAST_NAME < 'N%'
ORDER BY LAST_NAME;
```

* How many students are in each grade?
```SQL
SELECT GRADE, COUNT(*) FROM STUDENTS
GROUP BY GRADE;
```

* Do they have room for that many 6th graders?
```SQL
SELECT MIN(CAPACITY) FROM SUBJECTS
JOIN CLASSES ON SUBJECTS.ID = CLASSES.SUBJECT_ID
JOIN ROOMS ON CLASSES.ROOM_ID = ROOMS.ID
WHERE GRADE = 6;
```

* Which teachers teach a class during all 7 periods?
```SQL
SELECT TEACHERS.LAST_NAME, COUNT(*) FROM TEACHERS
JOIN CLASSES ON TEACHERS.ID = CLASSES.TEACHER_ID
GROUP BY LAST_NAME HAVING COUNT(*) = 7
```

* Do any teachers teach multiple subjects? If so, which teachers?
```SQL
SELECT TEACHERS.*, COUNT(DISTINCT CLASSES.SUBJECT_ID) FROM TEACHERS
JOIN CLASSES ON TEACHERS.ID = CLASSES.TEACHER_ID
GROUP BY TEACHERS.ID HAVING COUNT(DISTINCT CLASSES.SUBJECT_ID) > 1;
```

* What class does Janis Ambrose teach during each period? Be sure to include all 7 periods in your report!
```SQL
WITH JANIS_CLASSES AS (SELECT PERIOD_ID, SUBJECTS.NAME FROM TEACHERS
  JOIN CLASSES ON TEACHERS.ID = CLASSES.TEACHER_ID
  JOIN SUBJECTS ON SUBJECTS.ID = CLASSES.SUBJECT_ID
  WHERE TEACHERS.ID = 391
)

SELECT PERIODS.ID, JANIS_CLASSES.NAME FROM PERIODS
LEFT OUTER JOIN JANIS_CLASSES ON PERIODS.ID = PERIOD_ID
```

